<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Hilbert spaces, states and linear operators · KeldyshED.jl</title><meta name="title" content="Hilbert spaces, states and linear operators · KeldyshED.jl"/><meta property="og:title" content="Hilbert spaces, states and linear operators · KeldyshED.jl"/><meta property="twitter:title" content="Hilbert spaces, states and linear operators · KeldyshED.jl"/><meta name="description" content="Documentation for KeldyshED.jl."/><meta property="og:description" content="Documentation for KeldyshED.jl."/><meta property="twitter:description" content="Documentation for KeldyshED.jl."/><meta property="og:url" content="https://krivenko.github.io/KeldyshED.jl/hilbert/"/><meta property="twitter:url" content="https://krivenko.github.io/KeldyshED.jl/hilbert/"/><link rel="canonical" href="https://krivenko.github.io/KeldyshED.jl/hilbert/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">KeldyshED.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Public API</span><ul><li><a class="tocitem" href="../operators/">Expressions with creation/annihilation operators of fermions</a></li><li class="is-active"><a class="tocitem" href>Hilbert spaces, states and linear operators</a><ul class="internal"><li><a class="tocitem" href="#Ordered-set-of-compound-indices"><span>Ordered set of compound indices</span></a></li><li><a class="tocitem" href="#Full-Hilbert-spaces-and-their-subspaces"><span>Full Hilbert spaces and their subspaces</span></a></li><li><a class="tocitem" href="#Quantum-states"><span>Quantum states</span></a></li><li><a class="tocitem" href="#Operators-acting-in-Hilbert-spaces"><span>Operators acting in Hilbert spaces</span></a></li><li><a class="tocitem" href="#autopartition"><span>Space autopartition algorithm</span></a></li></ul></li><li><a class="tocitem" href="../ed_core/">Exact Diagonalization solver</a></li><li><a class="tocitem" href="../gf/">Single-particle Green&#39;s functions</a></li><li><a class="tocitem" href="../evolution/">Density matrix and evolution operators</a></li></ul></li><li><a class="tocitem" href="../example/">Usage example</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Public API</a></li><li class="is-active"><a href>Hilbert spaces, states and linear operators</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Hilbert spaces, states and linear operators</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/krivenko/KeldyshED.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/krivenko/KeldyshED.jl/blob/master/docs/src/hilbert.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Hilbert-spaces,-states-and-linear-operators"><a class="docs-heading-anchor" href="#Hilbert-spaces,-states-and-linear-operators">Hilbert spaces, states and linear operators</a><a id="Hilbert-spaces,-states-and-linear-operators-1"></a><a class="docs-heading-anchor-permalink" href="#Hilbert-spaces,-states-and-linear-operators" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert" href="#KeldyshED.Hilbert"><code>KeldyshED.Hilbert</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>This module defines types of Hilbert spaces, state vectors and linear operators acting in these spaces. It also implements the space autopartition algorithm described in <a href="https://doi.org/10.1016/j.cpc.2015.10.023">Computer Physics Communications 200, March 2016, 274-284 (section 4.2)</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L21-L26">source</a></section></article><h2 id="Ordered-set-of-compound-indices"><a class="docs-heading-anchor" href="#Ordered-set-of-compound-indices">Ordered set of compound indices</a><a id="Ordered-set-of-compound-indices-1"></a><a class="docs-heading-anchor-permalink" href="#Ordered-set-of-compound-indices" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.SetOfIndices" href="#KeldyshED.Hilbert.SetOfIndices"><code>KeldyshED.Hilbert.SetOfIndices</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Mapping from a compound operator index <a href="../operators/#KeldyshED.Operators.IndicesType"><code>IndicesType</code></a> to a linear integer index. It provides a dictionary-like iteration interface, supports indexed read-only access, functions <code>keys()</code>, <code>values()</code> and <code>pairs()</code>, as well as the operator <code>in</code>.</p><p><strong>Fields</strong></p><ul><li><code>map_index_n::DataStructures.SortedDict{Vector{Union{Int64, String}}, Int64}</code>: The <a href="../operators/#KeldyshED.Operators.IndicesType"><code>IndicesType</code></a> -&gt; linear index map</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L48-L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.insert!-Tuple{KeldyshED.Hilbert.SetOfIndices, Vector{Union{Int64, String}}}" href="#Base.insert!-Tuple{KeldyshED.Hilbert.SetOfIndices, Vector{Union{Int64, String}}}"><code>Base.insert!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">insert!(
    soi::KeldyshED.Hilbert.SetOfIndices,
    indices::Vector{Union{Int64, String}}
) -&gt; DataStructures.SortedDict{Vector{Union{Int64, String}}, Int64, Base.Order.ForwardOrdering}
</code></pre><p>Insert a new compound operator index <code>indices</code> into <code>soi</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L78">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.insert!-Tuple{KeldyshED.Hilbert.SetOfIndices, Vararg{Any}}" href="#Base.insert!-Tuple{KeldyshED.Hilbert.SetOfIndices, Vararg{Any}}"><code>Base.insert!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">insert!(
    soi::KeldyshED.Hilbert.SetOfIndices,
    indices...
) -&gt; DataStructures.SortedDict{Vector{Union{Int64, String}}, Int64, Base.Order.ForwardOrdering}
</code></pre><p>Insert a new compound operator index built out of arguments <code>indices...</code> into <code>soi</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.reversemap-Tuple{KeldyshED.Hilbert.SetOfIndices}" href="#KeldyshED.Hilbert.reversemap-Tuple{KeldyshED.Hilbert.SetOfIndices}"><code>KeldyshED.Hilbert.reversemap</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reversemap(
    soi::KeldyshED.Hilbert.SetOfIndices
) -&gt; Vector{Vector{Union{Int64, String}}}
</code></pre><p>Build and return the reverse map <code>Int</code> -&gt; <a href="../operators/#KeldyshED.Operators.IndicesType"><code>IndicesType</code></a> out of a <a href="#KeldyshED.Hilbert.SetOfIndices"><code>SetOfIndices</code></a> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.matching_indices" href="#KeldyshED.Hilbert.matching_indices"><code>KeldyshED.Hilbert.matching_indices</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">matching_indices(
    soi_from::KeldyshED.Hilbert.SetOfIndices,
    soi_to::KeldyshED.Hilbert.SetOfIndices
) -&gt; Vector{Int64}
</code></pre><p>For each compound index in the set <code>soi_from</code>, find the linear index of that compound index within <code>soi_to</code> and collect the found linear indices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L119">source</a></section></article><h2 id="Full-Hilbert-spaces-and-their-subspaces"><a class="docs-heading-anchor" href="#Full-Hilbert-spaces-and-their-subspaces">Full Hilbert spaces and their subspaces</a><a id="Full-Hilbert-spaces-and-their-subspaces-1"></a><a class="docs-heading-anchor-permalink" href="#Full-Hilbert-spaces-and-their-subspaces" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.FockState" href="#KeldyshED.Hilbert.FockState"><code>KeldyshED.Hilbert.FockState</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">primitive type UInt64 &lt;: Unsigned 64</code></pre><p>Fermionic Fock state encoded as a sequence of zeros (unoccupied single-particle states) and ones (occupied states) in the binary representation of an integer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L149">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.translate" href="#KeldyshED.Hilbert.translate"><code>KeldyshED.Hilbert.translate</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">translate(
    fs::UInt64,
    bit_map::Vector{Int64};
    reverse
) -&gt; UInt64
</code></pre><p>Reshuffle single-particle states (bits) of a Fock state <code>fs</code> according to a given map <code>bit_map</code>. <code>bit_map</code> is understood as a reverse map if <code>reverse = true</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L160">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.HilbertSpace" href="#KeldyshED.Hilbert.HilbertSpace"><code>KeldyshED.Hilbert.HilbertSpace</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Abstract supertype for Hilbert space types.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L157">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.FullHilbertSpace" href="#KeldyshED.Hilbert.FullHilbertSpace"><code>KeldyshED.Hilbert.FullHilbertSpace</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>A Hilbert space spanned by all fermionic Fock states generated by a given set of creation/annihilation operators. This type supports vector-like iteration over Fock states, read-only indexed access and the operator <code>in</code>.</p><p><strong>Fields</strong></p><ul><li><p><code>soi::KeldyshED.Hilbert.SetOfIndices</code>: Set of compound operator indices used to generate this space</p></li><li><p><code>dim::UInt64</code>: Dimension of the space</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L185-L193">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.FullHilbertSpace-Tuple{KeldyshED.Hilbert.SetOfIndices}" href="#KeldyshED.Hilbert.FullHilbertSpace-Tuple{KeldyshED.Hilbert.SetOfIndices}"><code>KeldyshED.Hilbert.FullHilbertSpace</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FullHilbertSpace(
    soi::KeldyshED.Hilbert.SetOfIndices
) -&gt; KeldyshED.Hilbert.FullHilbertSpace
</code></pre><p>Make a Hilbert space generated by creation/annihilation operators carrying compound indices from a given set <code>soi</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L201">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.getindex-Tuple{KeldyshED.Hilbert.FullHilbertSpace, Set{Vector{Union{Int64, String}}}}" href="#Base.getindex-Tuple{KeldyshED.Hilbert.FullHilbertSpace, Set{Vector{Union{Int64, String}}}}"><code>Base.getindex</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getindex(
    fhs::KeldyshED.Hilbert.FullHilbertSpace,
    soi_indices::Set{Vector{Union{Int64, String}}}
) -&gt; UInt64
</code></pre><p>Return the Fock state <span>$|\psi\rangle \propto c^\dagger_i c^\dagger_j c^\dagger_k \ldots |0\rangle$</span>, where the compound indices <span>$i,j,k,\ldots$</span> form a given set <code>soi_indices</code> and the creation operators act in a Hilbert space <code>fhs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L222">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.:⊗-Tuple{KeldyshED.Hilbert.FullHilbertSpace, KeldyshED.Hilbert.FullHilbertSpace}" href="#KeldyshED.Hilbert.:⊗-Tuple{KeldyshED.Hilbert.FullHilbertSpace, KeldyshED.Hilbert.FullHilbertSpace}"><code>KeldyshED.Hilbert.:⊗</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">⊗(
    H_A::KeldyshED.Hilbert.FullHilbertSpace,
    H_B::KeldyshED.Hilbert.FullHilbertSpace
) -&gt; KeldyshED.Hilbert.FullHilbertSpace
</code></pre><p>Construct a direct product of full Hilbert spaces <span>$H_A \otimes H_B$</span> under the assumption that the sets of indices generating <span>$H_A$</span> and <span>$H_B$</span> are disjoint.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L275">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:/-Tuple{KeldyshED.Hilbert.FullHilbertSpace, KeldyshED.Hilbert.FullHilbertSpace}" href="#Base.:/-Tuple{KeldyshED.Hilbert.FullHilbertSpace, KeldyshED.Hilbert.FullHilbertSpace}"><code>Base.:/</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">/(
    H_AB::KeldyshED.Hilbert.FullHilbertSpace,
    H_A::KeldyshED.Hilbert.FullHilbertSpace
) -&gt; KeldyshED.Hilbert.FullHilbertSpace
</code></pre><p>Construct a quotient space <span>$H_{AB} / H_A$</span> under the assumption that the sets of indices generating <span>$H_{AB}$</span> and <span>$H_A$</span> satisfy <span>$soi(H_A) \subseteq soi(H_{AB})$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L287">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.product_basis_map" href="#KeldyshED.Hilbert.product_basis_map"><code>KeldyshED.Hilbert.product_basis_map</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">product_basis_map(
    H_A::KeldyshED.Hilbert.FullHilbertSpace,
    H_B::KeldyshED.Hilbert.FullHilbertSpace,
    H_AB::KeldyshED.Hilbert.FullHilbertSpace
) -&gt; Matrix{Int64}
</code></pre><p>Given three Hilbert spaces <span>$H_A$</span>, <span>$H_B$</span> and <span>$H_{AB}$</span>, construct all product Fock states <span>$|\psi\rangle_{AB} = |\psi\rangle_A ⊗ |\psi\rangle_B$</span>, where <span>$|\psi\rangle_A ∈ H_A, |\psi\rangle_B ∈ H_B, |\psi\rangle_{AB} ∈ H_{AB}$</span>. Return a mapping (an integer-valued matrix) <span>$i, j \mapsto k$</span>, where <span>$i$</span>, <span>$j$</span> and <span>$k$</span> are linear indices of <span>$|\psi\rangle_A$</span>, <span>$|\psi\rangle_B$</span> and <span>$|\psi\rangle_{AB}$</span> within their respective spaces.</p><p>Sets of indices <span>$soi(H_A)$</span>, <span>$soi(H_B)$</span> must be disjoint and satisfy <span>$soi(H_A) \subseteq soi(H_{AB})$</span>, <span>$soi(H_B) \subseteq soi(H_{AB})$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L299">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.factorized_basis_map" href="#KeldyshED.Hilbert.factorized_basis_map"><code>KeldyshED.Hilbert.factorized_basis_map</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">factorized_basis_map(
    H_AB::KeldyshED.Hilbert.FullHilbertSpace,
    H_A::KeldyshED.Hilbert.FullHilbertSpace
) -&gt; Vector{Tuple{Int64, Int64}}
</code></pre><p>Given a Hilbert space <span>$H_{AB}$</span> and its divisor <span>$H_A$</span>, factorize all Fock states <span>$|\psi\rangle_{AB} \in H_{AB}$</span> into a direct product <span>$|\psi\rangle_A \otimes |\psi\rangle_B$</span>, where <span>$|\psi\rangle_A \in H_A$</span>, <span>$|\psi\rangle_B \in H_{AB} / H_A$</span>. Return a mapping (a vector of integer pairs) <span>$k \mapsto (i, j)$</span>, where <span>$i$</span>, <span>$j$</span> and <span>$k$</span> are linear indices of <span>$|\psi\rangle_A$</span>, <span>$|\psi\rangle_B$</span> and <span>$|\psi\rangle_{AB}$</span> within their respective spaces.</p><p>Sets of indices <span>$soi(H_{AB})$</span>, <span>$soi(H_A)$</span> must satisfy <span>$soi(H_A) \subseteq soi(H_{AB})$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L324">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.HilbertSubspace" href="#KeldyshED.Hilbert.HilbertSubspace"><code>KeldyshED.Hilbert.HilbertSubspace</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Subspace of a Hilbert space, as a list of basis Fock states.</p><p>This type supports vector-like iteration over Fock states, read-only indexed access and the operator <code>in</code>.</p><p><strong>Fields</strong></p><ul><li><p><code>fock_states::Vector{UInt64}</code>: List of all Fock states spanning the space</p></li><li><p><code>fock_to_index::Dict{UInt64, Int64}</code>: Reverse map to quickly find the index of a basis Fock state</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L355-L364">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.insert!-Tuple{KeldyshED.Hilbert.HilbertSubspace, UInt64}" href="#Base.insert!-Tuple{KeldyshED.Hilbert.HilbertSubspace, UInt64}"><code>Base.insert!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">insert!(
    hss::KeldyshED.Hilbert.HilbertSubspace,
    fs::UInt64
) -&gt; Int64
</code></pre><p>Insert a basis Fock state <code>fs</code> into a subspace <code>hss</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L374">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.getstateindex" href="#KeldyshED.Hilbert.getstateindex"><code>KeldyshED.Hilbert.getstateindex</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getstateindex(
    fhs::KeldyshED.Hilbert.FullHilbertSpace,
    fs::UInt64
) -&gt; Int64
</code></pre><p>Find the index of a given Fock state <code>fs</code> within a full Hilbert space <code>fhs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L235">source</a></section><section><div><pre><code class="language-julia hljs">getstateindex(
    hss::KeldyshED.Hilbert.HilbertSubspace,
    fs::UInt64
) -&gt; Int64
</code></pre><p>Find the index of a given Fock state <code>fs</code> within a subspace <code>hss</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L392">source</a></section></article><h2 id="Quantum-states"><a class="docs-heading-anchor" href="#Quantum-states">Quantum states</a><a id="Quantum-states-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-states" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.State" href="#KeldyshED.Hilbert.State"><code>KeldyshED.Hilbert.State</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Abstract supertype of quantum state types</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L419">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.StateVector" href="#KeldyshED.Hilbert.StateVector"><code>KeldyshED.Hilbert.StateVector</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Quantum state in a Hilbert space/subspace implemented as a vector of amplitudes.</p><p>The amplitudes can be accessed using the indexing interface and iterated over. States support addition/subtraction and multiplication/division by a constant scalar.</p><p><strong>Fields</strong></p><ul><li><p><code>hs::KeldyshED.Hilbert.HilbertSpace</code>: Hilbert space this state belongs to</p></li><li><p><code>amplitudes::Vector</code>: Amplitudes of basis states contributing to this state</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L426-L435">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.StateVector-Tuple{Any}" href="#KeldyshED.Hilbert.StateVector-Tuple{Any}"><code>KeldyshED.Hilbert.StateVector</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">StateVector{HSType, S}(hs::HSType) where {HSType, S}</code></pre><p>Create a vector-based state in a Hilbert space/subspace <code>hs</code> with all amplitudes set to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L443-L450">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.StateDict" href="#KeldyshED.Hilbert.StateDict"><code>KeldyshED.Hilbert.StateDict</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Quantum state in a Hilbert space/subspace implemented as a (sparse) dictionary of amplitudes.</p><p>The amplitudes can be accessed using the indexing interface and iterated over. States support addition/subtraction and multiplication/division by a constant scalar.</p><p><strong>Fields</strong></p><ul><li><p><code>hs::KeldyshED.Hilbert.HilbertSpace</code>: Hilbert space this state belongs to</p></li><li><p><code>amplitudes::Dict{Int64}</code>: Non-vanishing amplitudes of basis states contributing to this state. Each element of this dictionary is a pair (index of the basis state within <code>hs</code>, amplitude).</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L547-L557">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.StateDict-Tuple{Any}" href="#KeldyshED.Hilbert.StateDict-Tuple{Any}"><code>KeldyshED.Hilbert.StateDict</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">StateDict{HSType, S}(hs::HSType) where {HSType, S}</code></pre><p>Create a dictionary-based state in a Hilbert space/subspace <code>hs</code> with zero non-vanishing amplitudes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L568-L575">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.similar" href="#Base.similar"><code>Base.similar</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">similar(
    sv::KeldyshED.Hilbert.StateVector{HSType, S}
) -&gt; KeldyshED.Hilbert.StateVector
</code></pre><p>Create a vector-based state similar to <code>sv</code> with all amplitudes set to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L455">source</a></section><section><div><pre><code class="language-julia hljs">similar(
    sd::KeldyshED.Hilbert.StateDict{HSType, S}
) -&gt; KeldyshED.Hilbert.StateDict
</code></pre><p>Create a dictionary-based state similar to <code>sd</code> with zero non-vanishing amplitudes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L580">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.dot" href="#KeldyshED.Hilbert.dot"><code>KeldyshED.Hilbert.dot</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dot(
    sv1::KeldyshED.Hilbert.StateVector,
    sv2::KeldyshED.Hilbert.StateVector
) -&gt; Any
</code></pre><p>Compute the scalar product of two vector-based states <code>sv1</code> and <code>sv2</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L491">source</a></section><section><div><pre><code class="language-julia hljs">dot(
    sd1::KeldyshED.Hilbert.StateDict{HSType, S},
    sd2::KeldyshED.Hilbert.StateDict{HSType, S}
) -&gt; Any
</code></pre><p>Compute the scalar product of two dictionary-based states <code>sd1</code> and <code>sd2</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L629">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.project" href="#KeldyshED.Hilbert.project"><code>KeldyshED.Hilbert.project</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">project(
    sv::KeldyshED.Hilbert.StateVector{HSType, S},
    target_space
) -&gt; KeldyshED.Hilbert.StateVector
</code></pre><p>Project a vector-based state <code>sv</code> from one Hilbert space onto another Hilbert space/subspace <code>target_space</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L525">source</a></section><section><div><pre><code class="language-julia hljs">project(
    sd::KeldyshED.Hilbert.StateDict{HSType, S},
    target_space
) -&gt; KeldyshED.Hilbert.StateVector
</code></pre><p>Project a dictionary-based state <code>sd</code> from one Hilbert space onto another Hilbert space/subspace <code>target_space</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L661">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.show-Union{Tuple{S}, Tuple{HSType}, Tuple{IO, KeldyshED.Hilbert.StateVector{HSType, S}}} where {HSType, S}" href="#Base.show-Union{Tuple{S}, Tuple{HSType}, Tuple{IO, KeldyshED.Hilbert.StateVector{HSType, S}}} where {HSType, S}"><code>Base.show</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">show(io::IO, sv::KeldyshED.Hilbert.StateVector{HSType, S})
</code></pre><p>Print a vector-based state.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L507">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.show-Union{Tuple{S}, Tuple{HSType}, Tuple{IO, KeldyshED.Hilbert.StateDict{HSType, S}}} where {HSType, S}" href="#Base.show-Union{Tuple{S}, Tuple{HSType}, Tuple{IO, KeldyshED.Hilbert.StateDict{HSType, S}}} where {HSType, S}"><code>Base.show</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">show(io::IO, sd::KeldyshED.Hilbert.StateDict{HSType, S})
</code></pre><p>Print a dictionary-based state.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L642">source</a></section></article><h2 id="Operators-acting-in-Hilbert-spaces"><a class="docs-heading-anchor" href="#Operators-acting-in-Hilbert-spaces">Operators acting in Hilbert spaces</a><a id="Operators-acting-in-Hilbert-spaces-1"></a><a class="docs-heading-anchor-permalink" href="#Operators-acting-in-Hilbert-spaces" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.Operator" href="#KeldyshED.Hilbert.Operator"><code>KeldyshED.Hilbert.Operator</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Quantum-mechanical operator acting on states in a Hilbert space.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L715-L717">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.Operator-Union{Tuple{S}, Tuple{HSType}, Tuple{KeldyshED.Operators.OperatorExpr{S}, KeldyshED.Hilbert.SetOfIndices}} where {HSType, S}" href="#KeldyshED.Hilbert.Operator-Union{Tuple{S}, Tuple{HSType}, Tuple{KeldyshED.Operators.OperatorExpr{S}, KeldyshED.Hilbert.SetOfIndices}} where {HSType, S}"><code>KeldyshED.Hilbert.Operator</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Operator{HSType, S}(op_expr::OperatorExpr{S}, soi::SetOfIndices) where {HSType, S}</code></pre><p>Make a linear operator acting on a Hilbert space/subspace out of a <a href="../operators/#KeldyshED.Operators.OperatorExpr"><code>polynomial expression</code></a> <code>op_expr</code>. The set <code>soi</code> is used to establish a correspondence between compound indices of creation/annihilation operators met in <code>op_expr</code> and the single-particle states – bits of <a href="#KeldyshED.Hilbert.FockState"><code>FockState</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L722-L731">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Union{Tuple{StateType}, Tuple{KeldyshED.Hilbert.Operator, StateType}} where StateType&lt;:KeldyshED.Hilbert.State" href="#Base.:*-Union{Tuple{StateType}, Tuple{KeldyshED.Hilbert.Operator, StateType}} where StateType&lt;:KeldyshED.Hilbert.State"><code>Base.:*</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">*(
    op::KeldyshED.Hilbert.Operator,
    st::KeldyshED.Hilbert.State
) -&gt; Any
</code></pre><p>Act with an operator <code>op</code> on a state <code>st</code> and return the resulting state.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L777">source</a></section></article><h2 id="autopartition"><a class="docs-heading-anchor" href="#autopartition">Space autopartition algorithm</a><a id="autopartition-1"></a><a class="docs-heading-anchor-permalink" href="#autopartition" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.SpacePartition" href="#KeldyshED.Hilbert.SpacePartition"><code>KeldyshED.Hilbert.SpacePartition</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Partition of a Hilbert space into a set of disjoint subspaces invariant under action of a given Hermitian operator (Hamiltonian).</p><p>A detailed description of the algorithm can be found in Section 4.2 of <a href="https://doi.org/10.1016/j.cpc.2015.10.023">Computer Physics Communications 200, March 2016, 274-284</a>.</p><p><a href="#KeldyshED.Hilbert.SpacePartition"><code>SpacePartition</code></a> supports iteration over pairs (index of a basis state of the Hilbert space, index of the invariant subspace that state belongs to).</p><p><strong>Fields</strong></p><ul><li><p><code>hs::KeldyshED.Hilbert.HilbertSpace</code>: Full Hilbert space subject to partitioning</p></li><li><p><code>subspaces::DataStructures.IntDisjointSets</code>: Disjoint set of subspaces</p></li><li><p><code>root_to_index::Dict{Int64, Int64}</code>: Map root index to subspace index</p></li><li><p><code>matrix_elements::SparseArrays.SparseMatrixCSC{ScalarType, Int64} where ScalarType&lt;:Number</code>: Matrix elements of the Hamiltonian</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L805-L819">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.SpacePartition-Union{Tuple{OperatorType}, Tuple{S}, Tuple{HSType}, Tuple{HSType, OperatorType, Bool}} where {HSType&lt;:KeldyshED.Hilbert.HilbertSpace, S&lt;:Number, OperatorType&lt;:KeldyshED.Hilbert.Operator}" href="#KeldyshED.Hilbert.SpacePartition-Union{Tuple{OperatorType}, Tuple{S}, Tuple{HSType}, Tuple{HSType, OperatorType, Bool}} where {HSType&lt;:KeldyshED.Hilbert.HilbertSpace, S&lt;:Number, OperatorType&lt;:KeldyshED.Hilbert.Operator}"><code>KeldyshED.Hilbert.SpacePartition</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SpacePartition{HSType, S}(hs::HSType,
                          H::OperatorType,
                          store_matrix_elements::Bool = true) where {
    HSType &lt;: HilbertSpace, S &lt;: Number, OperatorType &lt;: Operator}</code></pre><p>Create a <a href="#KeldyshED.Hilbert.SpacePartition"><code>SpacePartition</code></a> structure by performing Phase I of the automatic partitioning algorithm, i.e. discovering the invariant subspaces of the Hermitian operator <code>H</code> acting on the Hilbert space <code>hs</code>.</p><p>If <code>store_matrix_elements = true</code>, the field <code>matrix_elements</code> of the created structure contains a sparse-matrix representation of <code>H</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L831-L845">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.merge_subspaces!" href="#KeldyshED.Hilbert.merge_subspaces!"><code>KeldyshED.Hilbert.merge_subspaces!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">merge_subspaces!(sp, op)
merge_subspaces!(sp, op, store_matrix_elements)
</code></pre><p>Merge some of the invariant subspaces in <code>sp</code> to ensure that the resulting subspaces are also invariant w.r.t. a given operator <code>op</code>.</p><p>If <code>store_matrix_elements = true</code>, a sparse-matrix representation of <code>op</code> is returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L907">source</a></section><section><div><pre><code class="language-julia hljs">merge_subspaces!(sp, Cd, C)
merge_subspaces!(sp, Cd, C, store_matrix_elements)
</code></pre><p>Perform Phase II of the automatic partition algorithm.</p><p>Merge some of the invariant subspaces in <code>sp</code> to ensure that a given operator <code>Cd</code> and its Hermitian conjugate <code>C</code> generate only one-to-one connections between the subspaces.</p><p>If <code>store_matrix_elements = true</code>, a tuple of two sparse matrices representing <code>Cd</code> and <code>C</code> is returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L930">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="KeldyshED.Hilbert.numsubspaces" href="#KeldyshED.Hilbert.numsubspaces"><code>KeldyshED.Hilbert.numsubspaces</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">numsubspaces(sp::KeldyshED.Hilbert.SpacePartition) -&gt; Int64
</code></pre><p>Return the number of subspaces in a space partition <code>sp</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L862">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.getindex-Tuple{KeldyshED.Hilbert.SpacePartition, Any}" href="#Base.getindex-Tuple{KeldyshED.Hilbert.SpacePartition, Any}"><code>Base.getindex</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getindex(
    sp::KeldyshED.Hilbert.SpacePartition,
    index
) -&gt; Int64
</code></pre><p>Find the invariant subspace within a partition <code>sp</code>, the state with a given <code>index</code> belongs to.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/krivenko/KeldyshED.jl/blob/6a266b710ef1c52be45651f4ff5efa0c8da855b8/src/hilbert.jl#L869">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../operators/">« Expressions with creation/annihilation operators of fermions</a><a class="docs-footer-nextpage" href="../ed_core/">Exact Diagonalization solver »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Saturday 9 November 2024 12:17">Saturday 9 November 2024</span>. Using Julia version 1.10.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
